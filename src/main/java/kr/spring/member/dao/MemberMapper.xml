<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper  namespace="kr.spring.member.dao.MemberMapper">
	<insert id="insertMember_detail" parameterType="memberVO">
	insert into member_detail
		(id,nickname,profile_image,thumbnail_image,email,age_range) 
	values
		(#{id},#{nickname},#{profile_image},#{thumbnail_image},#{email}
		<if test="age_range != null">
			,#{age_range}
		</if>
		)
	</insert>
	<update id="updateMember_detail" parameterType="memberVO">
	update member_detail set 
		nickname=#{nickname},profile_image=#{profile_image},thumbnail_image=#{thumbnail_image},email=#{email}
		<if test="age_range != null">
		,age_range=#{age_range}
		</if>
		 where id=#{id}	
	</update>   
	<select id="selectMyRecruitReq" parameterType="string" resultType="matchVO">
		select * from 
    (select recruit_req_num,isCanceled,c.id,c.match_num,c.club_num,recruit_position,recruit_accept,type,start_time,end_time,cancel,address,match_date,address_x,address_y,club_name,club_img,club_color,club_age from
        (select recruit_req_num,isCanceled,a.match_num,a.id,club_num,recruit_accept,recruit_position,type,start_time,end_time,cancel,address,match_date,address_x,address_y from
            (select * from recruit_req where id=1459494566) a join (select * from match where match_date>sysdate-1) b on a.match_num=b.match_num)c join club d on c.club_num=d.club_num) e left outer join
    (select avg(manner) manner,avg(perform) perform,club_num,count(*) count from club_rating group by club_num) f on e.club_num=f.club_num
	</select>
</mapper>
